apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: elasticsearch-master
spec:
  template:
    spec:
      containers:
        - name: elasticsearch
          env:
            - name: MY_POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: ELASTICSEARCH_CLUSTER_HOSTS
              value:  "elasticsearch-master-hl,"
            - name: ELASTICSEARCH_ADVERTISED_HOSTNAME
              value: "$(MY_POD_NAME).elasticsearch-master-hl"
      # the manifests generated from the Helm chart have 'volumes: ` (i.e. nil).
      # Kustomize doesn't seem to like that, so make it explicitly empty instead
      volumes: []
