apiVersion: kustomize.config.k8s.io/v1alpha1
kind: Component

patches:
  - target:
      version: v1
      group: apps
      kind: Deployment
    patch: &ol-patch |-
      # add oss tag for objects running 3rd party software
      - op: add
        path: /metadata/annotations/app.uw.systems~1tags.oss
        value: "true"
      # add 'app' label for autogenerated links (metrics, etc.)
      - op: copy
        path: /spec/template/metadata/labels/app
        from: /metadata/name
  - target:
      version: v1
      group: apps
      kind: StatefulSet
    patch: *ol-patch
